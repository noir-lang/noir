<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The purpose of the `array_set_optimization` SSA pass is to mark `ArraySet` instructions as mutable iff the array is not potentially shared with the callers or callees of the function and wonâ€™t be used again in the function itself either. In other words, if this is the last time we use this version of the array, we can mutate it in place, and avoid having to make a copy of it."><title>noirc_evaluator::ssa::opt::array_set - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-46132b98.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="noirc_evaluator" data-themes="" data-resource-suffix="" data-rustdoc-version="1.85.0 (4d91de4e4 2025-02-17)" data-channel="1.85.0" data-search-js="search-75f5ac3e.js" data-settings-js="settings-0f613d39.js" ><script src="../../../../static.files/storage-59e33391.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../noirc_evaluator/index.html">noirc_<wbr>evaluator</a><span class="version">1.0.0-beta.18</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module array_<wbr>set</a></h2><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In noirc_<wbr>evaluator::<wbr>ssa::<wbr>opt</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../../index.html">noirc_evaluator</a>::<wbr><a href="../../index.html">ssa</a>::<wbr><a href="../index.html">opt</a></span><h1>Module <span>array_set</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../src/noirc_evaluator/ssa/opt/array_set.rs.html#1-451">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The purpose of the <code>array_set_optimization</code> SSA pass is to mark <code>ArraySet</code> instructions
as mutable <em>iff</em> the array is not potentially shared with the callers or callees of the
function and wonâ€™t be used again in the function itself either. In other words, if this
is the last time we use this version of the array, we can mutate it in place, and avoid
having to make a copy of it.</p>
<p>This optimization only applies to ACIR. In Brillig we use ref-counting to decide when
there are no other references to an array.
This pass assumes that Load and Store instructions have been previously removed.</p>
<p>The pass is expected to run at most once, and requires these passes to occur before itself:</p>
<ul>
<li>unrolling</li>
<li>flattening</li>
<li>removal of if-else instructions</li>
<li>mem2reg and DIE, in order to remove Load/Store instructions</li>
</ul>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Context.html" title="struct noirc_evaluator::ssa::opt::array_set::Context">Context</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.array_set_optimization_post_check.html" title="fn noirc_evaluator::ssa::opt::array_set::array_set_optimization_post_check">array_<wbr>set_<wbr>optimization_<wbr>post_<wbr>check</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Post-check condition for <a href="../../ir/function/struct.Function.html#method.array_set_optimization" title="method noirc_evaluator::ssa::ir::function::Function::array_set_optimization">Function::array_set_optimization</a>.</div></li><li><div class="item-name"><a class="fn" href="fn.array_set_optimization_pre_check.html" title="fn noirc_evaluator::ssa::opt::array_set::array_set_optimization_pre_check">array_<wbr>set_<wbr>optimization_<wbr>pre_<wbr>check</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Pre-check condition for <a href="../../ir/function/struct.Function.html#method.array_set_optimization" title="method noirc_evaluator::ssa::ir::function::Function::array_set_optimization">Function::array_set_optimization</a>.</div></li><li><div class="item-name"><a class="fn" href="fn.make_mutable.html" title="fn noirc_evaluator::ssa::opt::array_set::make_mutable">make_<wbr>mutable</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Make each ArraySet instruction in <code>instructions_to_update</code> mutable.</div></li></ul></section></div></main></body></html>