<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Memory layout and register allocation for Brillig programs."><title>noirc_evaluator::brillig::brillig_ir::registers - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-46132b98.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="noirc_evaluator" data-themes="" data-resource-suffix="" data-rustdoc-version="1.85.0 (4d91de4e4 2025-02-17)" data-channel="1.85.0" data-search-js="search-75f5ac3e.js" data-settings-js="settings-0f613d39.js" ><script src="../../../../static.files/storage-59e33391.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../noirc_evaluator/index.html">noirc_<wbr>evaluator</a><span class="version">1.0.0-beta.16</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module registers</a></h2><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#constants" title="Constants">Constants</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In noirc_<wbr>evaluator::<wbr>brillig::<wbr>brillig_<wbr>ir</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../../index.html">noirc_evaluator</a>::<wbr><a href="../../index.html">brillig</a>::<wbr><a href="../index.html">brillig_ir</a></span><h1>Module <span>registers</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../src/noirc_evaluator/brillig/brillig_ir/registers.rs.html#1-770">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Memory layout and register allocation for Brillig programs.</p>
<p>Brillig execution splits its memory/register space into fixed and dynamic regions. The layout
is strictly enforced by the register allocators defined in this module.</p>
<p>The regions are as follows:</p>
<ol>
<li>Reserved registers: Used internally by the VM for special purposes (e.g., stack pointer,
free memory pointer, etc.). These registers occupy the lowest memory addresses.</li>
<li>Scratch space: Temporary memory used for procedure arguments and return values, allowing
function calls without saving/restoring the stack. Scratch space uses direct addressing.</li>
<li>Globals: Read-only memory initialized at the beginning of the program. The size is
determined during global variable compilation and may vary per program. Starts immediately
after the scratch space.</li>
<li>Entry point: Memory region containing program input arguments and reserved space for return values.
Starts immediately after the globals and ends before the stack.</li>
<li>Stack: Dynamic stack frames used for function-local variables. Each function call
creates its own view of the stack. Stack uses relative addressing for stack frames.</li>
<li>Heap: Dynamic memory allocated after the stack for arrays, vectors, and other data
structures. Starts immediately after the stack region.</li>
</ol>
<p>This module contains:</p>
<ul>
<li><a href="struct.LayoutConfig.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::LayoutConfig">LayoutConfig</a>: Centralized configuration of maximum sizes for stack frames, total stack size,
and scratch space. All register allocators query this configuration to determine their memory bounds.
This config is meant to be immutable and provides the following benefits:
<ul>
<li>Clear separation between memory layout policy and actual code generation.</li>
<li>Unit tests to vary memory layouts and ensure bytecode remains consistent.</li>
</ul>
</li>
<li><a href="trait.RegisterAllocator.html" title="trait noirc_evaluator::brillig::brillig_ir::registers::RegisterAllocator">RegisterAllocator</a>: Trait implemented by all memory region allocators. Each allocator is expected
to enforce its own bounds checks and allocation/deallocation logic.</li>
<li><a href="struct.Stack.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::Stack">Stack</a>, <a href="struct.ScratchSpace.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::ScratchSpace">ScratchSpace</a>, and <a href="struct.GlobalSpace.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::GlobalSpace">GlobalSpace</a>: Register allocator implementations for each memory region.</li>
</ul>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Allocated.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::Allocated">Allocated</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Wrapper for a memory address which automatically deallocates itself
when it goes out of scope.</div></li><li><div class="item-name"><a class="struct" href="struct.AllocatedInner.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::AllocatedInner">Allocated<wbr>Inner</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="struct" href="struct.DeallocationListAllocator.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::DeallocationListAllocator">Deallocation<wbr>List<wbr>Allocator</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Register allocator that tracks a contiguous range of register slots using:</div></li><li><div class="item-name"><a class="struct" href="struct.GlobalSpace.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::GlobalSpace">Global<wbr>Space</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Globals have a separate memory space
This memory space is initialized once at the beginning of a program
and is read-only.</div></li><li><div class="item-name"><a class="struct" href="struct.LayoutConfig.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::LayoutConfig">Layout<wbr>Config</a></div><div class="desc docblock-short">Defines the memory layout for Brillig programs.</div></li><li><div class="item-name"><a class="struct" href="struct.ScratchSpace.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::ScratchSpace">Scratch<wbr>Space</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Procedure arguments and returns are passed through scratch space.
This avoids having to dump and restore the stack to call procedures.
The scratch space is a much smaller set of memory cells.</div></li><li><div class="item-name"><a class="struct" href="struct.Stack.html" title="struct noirc_evaluator::brillig::brillig_ir::registers::Stack">Stack</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Every brillig stack frame/call context has its own view of register space.
This is maintained by copying these registers to the stack during calls and reading them back.</div></li></ul><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.MAX_SCRATCH_SPACE.html" title="constant noirc_evaluator::brillig::brillig_ir::registers::MAX_SCRATCH_SPACE">MAX_<wbr>SCRATCH_<wbr>SPACE</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="constant" href="constant.MAX_STACK_FRAME_SIZE.html" title="constant noirc_evaluator::brillig::brillig_ir::registers::MAX_STACK_FRAME_SIZE">MAX_<wbr>STACK_<wbr>FRAME_<wbr>SIZE</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="constant" href="constant.NUM_STACK_FRAMES.html" title="constant noirc_evaluator::brillig::brillig_ir::registers::NUM_STACK_FRAMES">NUM_<wbr>STACK_<wbr>FRAMES</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.RegisterAllocator.html" title="trait noirc_evaluator::brillig::brillig_ir::registers::RegisterAllocator">Register<wbr>Allocator</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.AddressList.html" title="type noirc_evaluator::brillig::brillig_ir::registers::AddressList">Address<wbr>List</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Address list with enough slots for <code>HeapVector</code>.</div></li></ul></section></div></main></body></html>